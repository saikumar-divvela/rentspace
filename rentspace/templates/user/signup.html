<html lang="en">

<head>
   {% include "init_header.html" %}

  <style>
    #alert {
        /* display: none; */
    }
  </style>
  <script type="text/javascript">

  $(function(){
    $("#submit").click(function(event){
               event.preventDefault(); 
               var data = $("#form1").serialize();
               //alert(data);
               $.ajax({
                    url: '/api/register',
                    dataType: 'json',
                    data: data,
                    type:'post'
                  }).done(handle_success)
                    .fail(handle_fail);
              });
  });

   
   function handle_success(data,statusText,xhr){
        location.href = "{% url 'register_success' %}"
   }

   function  handle_fail(xhr, statusText, errorThrown){
        console.log(xhr);        
        var resp = xhr.responseJSON
        $("div#alert").text(resp.message)
   }

   function testfunction(responseTxt, statusTxt, xhr){
       alert("Hi");  
       alert(statusTxt);
    }
  

</script>
</head>


  <div id="header">
    {% include "header.html" %}
  </div>

<body>
<div id="main">
  <form id="form1" role="form" method="post">
   {% csrf_token %}
    <div class="container clear-top">
      <div class="col-lg-offset-1 col-lg-6">
        <div class="panel panel-default">
          <div class='panel-heading'>
            <h3>Signup</h3>
          </div>
          <div class="panel-body">
            <div id="alert"> </div>
            <div class="form-group">
              <label for="username">User name(emailid)</label>
              <input type="email" class="form-control" id="username" name="username" placeholder="username">
            </div>
            <div class="form-group">
              <label for="pwd">Create a password</label>
              <input type="password" class="form-control" id="password" name="password">
            </div>
            <div class="form-group">
              <label for="pwd-repeat">Confirm your password</label>
              <input type="password" class="form-control" id="password-repeat" name="password-repeat">
            </div>
            <div class="form-group">
              <label for="first_name">Name</label>
            </div>
            <div class="row">
              <div class="col-lg-6">
                 <div class="form-group">
                    <input type="text" class="form-control" id="first_name" name="first_name" placeholder="First Name" required/>
                 </div>
              </div>
              <div class="col-lg-6">
                <div class="form-group">
                    <input type="text" class="form-control" id="last_name" name="last_name" placeholder="Last Name"/>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label for="phone_number">Mobile number</label><br/>
              <input type="text" id="phone_number" name="phone_number">
            </div>
            <div class="form-group">
                <input type="button" id="submit" class="btn btn-primary btn-lg" value="Create Account"></input>
            </div>
            <div class="form-group">
                <label for="newuser">Already have account?</label>
                <a href="{% url 'signin' %}">Login</a>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id = "stage" style = "background-color:cc0;">
         STAGE
      </div>
  </form>
  </div>
</body>
  <div id="footer">
    {% include "footer.html" %}
  </div>

</html>
